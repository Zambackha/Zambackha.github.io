<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>MicrowaveGames - Snake</title>

<style>
body, html{
    margin:0;
    padding:0;
    background:black;
    overflow:hidden;
    font-family:'Press Start 2P', cursive;
}

#gameCanvas{
    display:block;
    margin:auto;
    background:url('https://www.freeiconspng.com/uploads/line-grid-png-3.png'); 
    background-size:cover;
}

.game-over-text{
    position:absolute;
    top:40%;
    left:50%;
    transform:translate(-50%,-50%);
    color:red;
    font-size:48px;
    text-shadow:3px 3px black;
    display:none;
}

#restartBtn{
    position:absolute;
    top:55%;
    left:50%;
    transform:translate(-50%,-50%);
    padding:15px 30px;
    font-size:18px;
    border:none;
    border-radius:10px;
    background:red;
    color:white;
    display:none;
    cursor:pointer;
}
</style>
</head>
<body>

<canvas id="gameCanvas" width="600" height="600"></canvas>

<div id="gameOver" class="game-over-text"></div>

<button id="restartBtn">RESTART (ENTER)</button>

<script>

// ===== IMAGES =====

const snakeImg = new Image();
snakeImg.src = "https://colorcodes.imgix.net/h2QJwOdO6qsOX5WscSjFV/b3cb36546d93a69bd43258f30f45765d/bright-green-color-solid-background-1920x1080.png";

const foodImg = new Image();
foodImg.src = "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQEl05F5JrOQMJb6iDsPYkaYiSx_7EZmc_d4g&s";

// ===== CANVAS =====

const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

// ===== SETTINGS =====

const gridSize = 30;
const tileCount = canvas.width / gridSize;

let snake;
let food;
let dx;
let dy;
let score;
let gameOver;
let loop;

// ===== FAIL MESSAGES =====

const failMessages = [
"YOU SUCK",
"EMBARRASSING",
"SNAKE DISOWNED YOU",
"THAT WAS PATHETIC",
"TRY USING YOUR BRAIN",
"EVEN GRANDMA PLAYS BETTER"
];

// ===== INIT =====

function initGame(){

snake = [{x:10,y:10}];

dx = 1;
dy = 0;

score = 0;
gameOver=false;

food = randomFood();

document.getElementById("gameOver").style.display="none";
document.getElementById("restartBtn").style.display="none";

loop=setInterval(gameLoop,120);
}

// ===== RANDOM FOOD =====

function randomFood(){
return{
x:Math.floor(Math.random()*tileCount),
y:Math.floor(Math.random()*tileCount)
};
}

// ===== GAME LOOP =====

function gameLoop(){
update();
draw();
}

// ===== UPDATE =====

function update(){

if(gameOver) return;

const head={
x:snake[0].x+dx,
y:snake[0].y+dy
};

// wall collision
if(
head.x<0 ||
head.x>=tileCount ||
head.y<0 ||
head.y>=tileCount
){
endGame();
return;
}

// self collision
for(let part of snake){
if(part.x==head.x && part.y==head.y){
endGame();
return;
}
}

snake.unshift(head);

// food collision
if(head.x==food.x && head.y==food.y){
score++;
food=randomFood();
}
else{
snake.pop();
}
}

// ===== DRAW =====

function draw(){

ctx.clearRect(0,0,canvas.width,canvas.height);

// draw snake
for(let part of snake){
ctx.drawImage(
snakeImg,
part.x*gridSize,
part.y*gridSize,
gridSize,
gridSize
);
}

// draw food
ctx.drawImage(
foodImg,
food.x*gridSize,
food.y*gridSize,
gridSize,
gridSize
);

// draw score
ctx.fillStyle="white";
ctx.font="20px monospace";
ctx.fillText("SCORE: "+score,10,25);
}

// ===== CONTROLS =====

document.addEventListener("keydown",e=>{

// restart with Enter
if(e.key === "Enter" && gameOver){
initGame();
}

if(e.key=="ArrowUp" && dy==0){
dx=0;
dy=-1;
}

if(e.key=="ArrowDown" && dy==0){
dx=0;
dy=1;
}

if(e.key=="ArrowLeft" && dx==0){
dx=-1;
dy=0;
}

if(e.key=="ArrowRight" && dx==0){
dx=1;
dy=0;
}

});

// ===== GAME OVER =====

function endGame(){

gameOver=true;
clearInterval(loop);

const msg=
failMessages[
Math.floor(Math.random()*failMessages.length)
];

const text=document.getElementById("gameOver");
text.innerText=msg;
text.style.display="block";

const btn = document.getElementById("restartBtn");
btn.style.display="block";
}

// ===== RESTART =====

document.getElementById("restartBtn").onclick=()=>{
initGame();
};

// ===== START =====

initGame();

</script>

</body>
</html>
